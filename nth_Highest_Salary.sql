CREATE TABLE EMPLOYEE(EMPID int,DEPARTMENT VARCHAR(20), NAME VARCHAR(10),EXPERIENCE INT,SALARY INT);
insert into EMPLOYEE values(1,'PYTHON','ASHOK',10,130000);
insert into EMPLOYEE values(2,'PYTHON','SANJAY',12,150000);
insert into EMPLOYEE values(3,'TABLEAU','SUNIL',7,120000);
insert into EMPLOYEE values(4,'PYTHON','SFURTI',2,30000);
insert into EMPLOYEE values(5,'DATASTAGE','ANKIT',8,100000);
insert into EMPLOYEE values(6,'TABLEAU','ABHAY',9,120000);
insert into EMPLOYEE values(7,'TABLEAU','AYUSH',4,60000);
insert into EMPLOYEE values(8,'QLIKVIEW','MANISH',9,120000);
insert into EMPLOYEE values(9,'QLIKVIEW','AMIT',7,920000);
insert into EMPLOYEE values(10,'QLIKVIEW','VIJEET',6,750000);
insert into EMPLOYEE values(11,'QLIKVIEW','RIYA',5,60000);
insert into EMPLOYEE values(12,'SALESFORCE','RUPESH',11,140000);
insert into EMPLOYEE values(13,'SALESFORCE','SANTUL',8,90000);
insert into EMPLOYEE values(14,'SALESFORCE','SARTHAK',7,780000);
insert into EMPLOYEE values(15,'DATASTAGE','ASHISH',10,150000);
insert into EMPLOYEE values(16,'DATASTAGE','ATUL',8,120000);
insert into EMPLOYEE values(17,'DATASTAGE','KANIKA',4,50000);
insert into EMPLOYEE values(18,'INFORMATICA','ADITYA',3,100000);
insert into EMPLOYEE values(19,'INFORMATICA','SANJEEV',12,170000);
insert into EMPLOYEE values(20,'TABLEAU','ANKITB',9,110000);


Q1 Employee name & nth Highest Salary for each Department

SELECT * FROM (SELECT DEPARTMENT,NAME, SALARY,
row_number() OVER (PARTITION BY DEPARTMENT ORDER BY SALARY DESC) AS RANK
FROM EMPLOYEE) EMP 
WHERE 
EMP.RANK =2